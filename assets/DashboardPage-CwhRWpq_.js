import{b5 as fe,a as be,r as i,j as e,A as M,m as k,I as ge,b6 as je,c as xe,B,T as ve,w as _,b7 as ye,aN as Ne,Q as ke,b8 as we,al as Ce,ab as Se,b9 as Te,F as _e}from"./index-DCJW8iNa.js";import{u as me}from"./useEconomic-1aaKRIzj.js";import{E as Le}from"./jspdf.plugin.autotable-SxJb80S0.js";import{b as Pe}from"./date.util-DC23xNcO.js";import{d as Ee}from"./sale.api-CB5UlJU8.js";import{f as u}from"./convertFloatToDecimal.util-4Gwe17GD.js";import{s as Fe}from"./products.api-Cr5BJIRN.js";const $e=async()=>{try{return(await fe.get("/generate-ticket")).data}catch(N){throw new Error(`${N.response.data.message}`)}},ze=({cash:N,isOpen:U,change:L,onClose:f,formData:d,invoiceType:Z,onFinishSale:q,selectedProducts:b,handleInputChange:z})=>{const{economic:ee}=me(),{settings:m}=be(),[V,D]=i.useState(!1),[c,S]=i.useState(""),[w,C]=i.useState(!1),[v,A]=i.useState(Z),{formattedDate:H,formattedTime:G}=Pe(),K=async()=>{if(v)try{const g=await $e();S(g)}catch{}};i.useEffect(()=>{w&&(async()=>await K())()},[w,v]);const W=async()=>{D(!0);try{const n=new Le({orientation:"p",unit:"mm",format:[80,130]});n.setFont("Courier","normal");const h=5;let a=10,J=n.internal.pageSize.height;const P=()=>{const x=a;x>J-20&&(n.addPage([80,x+20],"p"),J=n.internal.pageSize.height,a=10)};(()=>{n.setFontSize(12);const x=70;n.splitTextToSize(m==null?void 0:m.property_name,x).forEach(j=>{P(),n.text(j,40,a,null,null,"center"),a+=6}),n.setFontSize(8),n.splitTextToSize(m==null?void 0:m.address,x).forEach(j=>{P(),n.text(j,40,a,null,null,"center"),a+=4}),n.text(`RUC: ${m==null?void 0:m.ruc}`,40,a,null,null,"center"),a+=4,n.text(`Tel: ${m==null?void 0:m.phone}`,40,a,null,null,"center"),a+=6,n.text("*********** DOCUMENTO NO LEGAL ***********",40,a,null,null,"center"),a+=6,n.setFontSize(7),v==="business"?(n.text(`Ticket N°: ${c}`,h,a),a+=4,n.text("Fecha: "+H+" - "+G,h,a),a+=4,n.text(`Cliente: ${d.name}`,h,a),a+=4,n.text(`Cédula: ${d.idNumber}`,h,a),n.text(`Teléfono: ${d.phone}`,45,a),a+=4,n.text(`Correo: ${d.email}`,h,a),a+=6):v==="consumer"&&(n.text(`Ticket N°: ${c}`,h,a),a+=4,n.text("Fecha: "+H+" - "+G,h,a),a+=4,n.text("Cliente: Consumidor Final",h,a),a+=4,n.text("Cédula: 9999999999",h,a),n.text("Teléfono: 9999999999",45,a),a+=4,n.text("Correo: @",h,a),a+=6),n.text("------------------------------------------------",40,a,null,null,"center"),a+=3,n.setFontSize(6),n.text("Descripción",h,a),n.text("Cnt",55,a,null,null,"right"),n.text("PU",65,a,null,null,"right"),n.text("Total",75,a,null,null,"right"),a+=3,n.text("--------------------------------------------------------",40,a,null,null,"center"),a+=4,b.forEach(j=>{const R=n.splitTextToSize(j.description,45);R.forEach((se,le)=>{P(),n.text(se,h,a),le===R.length-1&&(n.text(j.amount.toString(),55,a,null,null,"right"),n.text(u(j.price_profit),65,a,null,null,"right"),n.text(u(j.amount*j.price_profit),75,a,null,null,"right")),a+=3}),n.text("--------------------------------------------------------",40,a,null,null,"center"),a+=4})})();const E=b.reduce((x,O)=>x+O.amount*O.price_profit,0),Y=E*(ee.iva/100),I=E+Y;P(),n.text("Subtotal: "+u(E),75,a,null,null,"right"),a+=4,n.text("Impuestos: "+u(Y),75,a,null,null,"right"),a+=4,n.text("TOTAL: "+u(I),75,a,null,null,"right"),a+=4,n.text("Efectivo: "+u(N),75,a,null,null,"right"),a+=4,n.text("Cambio: "+u(L),75,a,null,null,"right"),a+=4,P(),n.text("Gracias por su compra!",45,a,null,null,"center"),n.save("recibo.pdf");const Q=n.output("datauristring").split(",")[1],p={invoiceType:v,clients:[{name:d.name,phone:d.phone,identification_card:d.idNumber,email:d.email}],bills:[{id_ticket:c,bill_pdf:Q,total:I}],cash:N,change:L,products:b.map(x=>({id_product:x.id_product,amount:x.amount}))},F=await Ee(p);_({type:"success",message:F.message})}catch(g){_({type:"error",message:g.message})}D(!1)},T=g=>A(g.target.value),X=async()=>C(!0),te=async()=>{await W(),q(),C(!1)},ae=()=>C(!1);return U?e.jsxs(e.Fragment,{children:[e.jsx(M,{children:e.jsx(k.div,{className:"fixed inset-0 z-40 flex items-center justify-center overflow-auto bg-neutral-50/50 backdrop-blur-sm dark:bg-neutral-900/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:e.jsxs(k.div,{className:"relative flex w-full max-w-md flex-col gap-y-5 rounded-lg border bg-white p-4 shadow-lg dark:border-neutral-700 dark:bg-neutral-900",initial:{scale:.9},animate:{scale:1},exit:{scale:.9},transition:{duration:.3},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ge,{Icon:je,text:"Facturación"}),e.jsx("button",{onClick:f,className:"cursor-pointer rounded-md p-1.5 text-lg text-neutral-400 transition-colors duration-150 hover:bg-neutral-100 hover:text-neutral-500 dark:hover:bg-neutral-800 dark:hover:text-neutral-300",children:e.jsx(xe,{})})]}),e.jsxs("form",{onSubmit:g=>{g.preventDefault(),X()},className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-col gap-3 text-sm text-neutral-600 dark:text-neutral-300",children:[e.jsx("label",{className:"text-xs font-medium",children:"Tipo de factura"}),e.jsxs("select",{value:v,onChange:T,className:"block w-full rounded-lg border border-neutral-200 bg-white p-2 focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:bg-neutral-800",children:[e.jsx("option",{value:"consumer",children:"Consumidor final"}),e.jsx("option",{value:"business",children:"Factura con datos"})]}),v==="business"&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"text-xs font-medium",children:["Nombres",e.jsx("input",{type:"text",name:"name",required:!0,value:d.name,onChange:z,className:"mt-1 block w-full rounded-lg border border-neutral-200 bg-white p-2 focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:border-e-neutral-700 dark:bg-neutral-800"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex-1 text-xs font-medium",children:["Cédula",e.jsx("input",{type:"text",name:"idNumber",required:!0,value:d.idNumber,onChange:z,className:"mt-1 block w-full rounded-lg border border-neutral-200 bg-white p-2 focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:border-e-neutral-700 dark:bg-neutral-800"})]}),e.jsxs("label",{className:"flex-1 text-xs font-medium",children:["Teléfono",e.jsx("input",{type:"text",name:"phone",required:!0,value:d.phone,onChange:z,className:"mt-1 block w-full rounded-lg border border-neutral-200 bg-white p-2 focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:border-e-neutral-700 dark:bg-neutral-800"})]})]}),e.jsxs("label",{className:"text-xs font-medium",children:["Correo",e.jsx("input",{type:"email",name:"email",required:!0,value:d.email,onChange:z,className:"mt-1 block w-full rounded-lg border border-neutral-200 bg-white p-2 focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:border-e-neutral-700 dark:bg-neutral-800"})]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-4",children:[e.jsx(B,{onClick:f,variant:"outline",type:"outline",size:"md",children:"No, cancelar"}),e.jsx(B,{variant:"primary",type:"submit",size:"md",children:"Ok, procesar"})]})]}),e.jsx(M,{children:w&&e.jsx(k.div,{className:"fixed inset-0 z-50 flex items-center justify-center overflow-auto bg-neutral-50/90 backdrop-blur-sm dark:bg-neutral-900/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:e.jsx(k.div,{className:"relative flex w-full max-w-sm flex-col rounded-lg border bg-white p-4 shadow-lg dark:border-neutral-700 dark:bg-neutral-900",initial:{scale:.9},animate:{scale:1},exit:{scale:.9},transition:{duration:.3},children:e.jsxs("div",{className:"flex flex-col gap-y-4 font-medium text-neutral-600 dark:text-neutral-300",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Hey, espera!!"}),e.jsx("p",{className:"text-sm",children:"¿Estás seguro de que deseas confirma la compra y generar un ticket de venta?"}),e.jsxs("div",{className:"flex justify-end gap-4",children:[!V&&e.jsx(B,{onClick:ae,variant:"outline",type:"button",size:"md",children:"No, cancelar"}),e.jsx(B,{onClick:te,variant:"primary",type:"button",size:"md",loading:V,children:V?"Generando ticket...":"Ok, confirmar"})]})]})})})})]})})}),e.jsx(ve,{})]}):null},Ae=()=>{const{economic:N}=me(),[U,L]=i.useState([]),[f,d]=i.useState(""),[Z,q]=i.useState(!1),[b,z]=i.useState("barcode"),[ee,m]=i.useState("consumer"),[V,D]=i.useState(!0),[c,S]=i.useState([]),[w,C]=i.useState([]),[v,A]=i.useState([]),H={name:"",phone:"",email:"",address:"",idNumber:""},[G,K]=i.useState(H),[W,T]=i.useState({});i.useEffect(()=>{(async()=>{if(f)try{D(!0);const r=await Fe(f,b);Array.isArray(r)?(L(r),A(s=>[...s,...r])):r&&typeof r=="object"?(L([r]),A(s=>[...s,r])):(console.error("Unexpected response format:",r),L([]),A([]))}catch(r){console.error("Error fetching products:",r)}finally{D(!1)}})()},[f,b]),i.useEffect(()=>{if(!f){w.length>0&&C([]);return}const t=f.toLowerCase(),r=U.filter(s=>{var o,l;return b==="barcode"?((o=s.code_bar)==null?void 0:o.toLowerCase())===t:(l=s.description)==null?void 0:l.toLowerCase().includes(t)});r.length!==w.length&&C(r),r.length===1&&(X(r[0]),f!==""&&d(""))},[f,U,w,b]);const X=t=>{const r=v.find(s=>s.code_product===t.code_product);r&&S(s=>{const o=s.find(l=>l.code_product===t.code_product);if(o){const l=o.amount+1;if(l>r.amount)return _({type:"warning",message:`No puedes agregar más de ${r.amount} unidades de ${o.description}.`}),s;const $=s.map(y=>y.code_product===t.code_product?{...y,amount:l}:y);return T(y=>({...y,[t.code_product]:l})),$}else{if(1>r.amount)return s;const l={...t,amount:1},$=[...s,l];return T(y=>({...y,[t.code_product]:1})),$}})},te=(t,r)=>{const s=Math.max(1,parseInt(r,10)),o=v.find(l=>l.code_product===t);if(o){if(s>o.amount){_({type:"warning",message:`No puedes agregar más de ${o.amount} unidades de ${o.description}.`});return}S(l=>l.map(y=>y.code_product===t?{...y,amount:s}:y)),T(l=>({...l,[t]:s}))}},ae=t=>{const r=v.find(s=>s.code_product===t);r&&(S(s=>s.map(l=>{if(l.code_product===t){const $=l.amount+1;return $>r.amount?(_({type:"warning",message:`No puedes agregar más de ${r.amount} unidades de ${r.description}.`}),l):{...l,amount:$}}return l})),T(s=>{const l=(s[t]||1)+1;return l>r.amount?(_({type:"warning",message:`No puedes agregar más de ${r.amount} unidades de ${r.description}.`}),s):{...s,[t]:l}}))},g=t=>{S(r=>r.map(s=>s.code_product===t&&s.amount>1?{...s,amount:s.amount-1}:s)),T(r=>({...r,[t]:Math.max(1,(r[t]||1)-1)}))},n=t=>{S(r=>r.filter(s=>s.code_product!==t)),T(r=>{const{[t]:s,...o}=r;return o})},h=t=>m(t.target.value),a=t=>{const{name:r,value:s}=t.target;K(o=>({...o,[r]:s}))},J=t=>{d(""),C([]),X(t)},P={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0}},ie={hidden:{opacity:0,x:20},visible:{opacity:1,x:0}},E={hidden:{opacity:0,y:-10},visible:{opacity:1,y:0,transition:{duration:.2,ease:"easeInOut"}},exit:{opacity:0,y:-10,transition:{duration:.2,ease:"easeInOut"}}},Y={hover:{scale:1.1,transition:{duration:.2}},tap:{scale:.9,transition:{duration:.2}}},[I,Q]=i.useState(0),[p,F]=i.useState("0.00"),[x,O]=i.useState(0),[re,j]=i.useState(null),[ne,R]=i.useState(!1);i.useEffect(()=>{const t=c.reduce((o,l)=>o+l.amount*l.price_profit,0),r=t*(N.iva/100),s=t+r;if(O(s),p&&parseFloat(p)>0){const o=parseFloat(p)||0;Q(o-s)}else Q(0)},[c,W,p,N.iva]);const se=t=>{const r=t.target.value;/^\d*\.?\d*$/.test(r)&&F(r)},le=t=>{t==="."?p.includes(".")||F(r=>r+t):F(r=>r==="0.00"?t:r+t),j(t),setTimeout(()=>{j(null)},300)},he=()=>F("0.00"),oe=()=>{R(t=>!t)};i.useEffect(()=>{const t=r=>{r.ctrlKey&&r.code==="Space"&&oe(),r.code==="Escape"&&R(!1)};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[]);const de=()=>{if(c.length===0){_({type:"warning",message:"No hay productos seleccionados."});return}else if(parseFloat(p)<x){_({type:"error",message:"EL efectivo es menor que el total a pagar."});return}q(!0)},ce=t=>{t.ctrlKey&&t.key==="Enter"&&de()};i.useEffect(()=>(window.addEventListener("keydown",ce),()=>{window.removeEventListener("keydown",ce)}),[c,p,x]);const pe=()=>q(!1),ue=()=>{S([]),C([]),A([]),K(H),F("0.00"),Q(0),O(0),q(!1)};return e.jsxs("main",{className:"mx-auto pt-20",children:[e.jsx(ye,{}),e.jsx("div",{className:"relative mx-auto w-full max-w-7xl items-center py-2 text-neutral-500 dark:text-neutral-300 md:px-9 lg:px-2",children:e.jsxs("div",{className:"mx-auto grid w-full grid-cols-1 gap-8 pb-16 lg:grid-cols-2",children:[e.jsx(M,{children:e.jsxs(k.div,{initial:"hidden",animate:"visible",exit:"hidden",variants:P,children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"flex flex-row items-center gap-4 pb-4 text-lg font-semibold",children:e.jsx("h2",{children:"Productos"})}),e.jsxs("div",{className:"flex flex-row items-center justify-between pb-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-sm",children:"Buscar por"}),e.jsxs("select",{className:"rounded-md border bg-neutral-50 px-4 py-2 text-sm dark:border-neutral-700 dark:bg-neutral-800",value:b,onChange:t=>{z(t.target.value),d(""),L([]),C([])},children:[e.jsx("option",{value:"barcode",children:"Código de barras"}),e.jsx("option",{value:"description",children:"Descripción de producto"}),e.jsx("option",{value:"service",children:"Servicio digital"})]})]}),e.jsxs("div",{className:"relative mt-5 flex w-auto items-center text-sm dark:bg-neutral-800",children:[e.jsx("input",{type:"text",value:f,onChange:t=>d(t.target.value),placeholder:`Buscar por ${b==="barcode"?"código de barra":b==="description"?"descripción":b==="service"?"servicio digital":""}`,className:"w-full rounded-md border p-2 px-4 pl-10 font-medium shadow-sm focus:outline-none focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:bg-neutral-800","aria-label":"Campo de búsqueda"}),e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center rounded-l-md border border-r-transparent pl-3 dark:border-neutral-700 dark:border-r-neutral-800 dark:bg-neutral-800",children:e.jsx(Ne,{size:18})})]})]}),V&&f!==""?e.jsx("div",{className:"} flex justify-center bg-neutral-50 p-4 text-sm",children:e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{children:"Buscando coincidencias..."})})}):f===""?e.jsx("div",{className:"flex justify-center bg-neutral-50 p-4 text-sm dark:bg-neutral-800",children:e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{children:"No has buscado ningún producto :("})})}):e.jsx("div",{className:"max-h-[calc(3*3.2rem)] space-y-2 overflow-y-auto",children:w.length>0?w.map(t=>e.jsxs(k.div,{initial:"hidden",animate:"visible",exit:"exit",variants:E,transition:{duration:.3},className:"mr-2 flex items-center justify-between bg-neutral-100/70 transition-colors duration-150 hover:bg-neutral-400 hover:text-neutral-50 dark:bg-neutral-800",children:[e.jsx("div",{className:"flex-1 border-l-4 border-neutral-400 px-3 py-2",children:e.jsx("h3",{className:"truncate text-xs font-medium",children:t.description})}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 bg-neutral-500 p-2 text-xs font-medium text-neutral-100 transition-colors duration-150 hover:bg-neutral-100/80 hover:text-neutral-600",onClick:()=>J(t),children:[e.jsx(ke,{size:14}),e.jsx("span",{children:"Añadir"})]})]},t.code_product)):e.jsx("div",{className:"flex justify-center bg-orange-50 p-4 text-sm text-orange-400 dark:bg-neutral-800",children:e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{children:"No se encontraron coincidencias :("})})})})]}),e.jsxs("div",{className:"flex flex-col pt-8",children:[e.jsx("div",{className:"flex flex-row items-center justify-between pb-2 text-base font-semibold",children:e.jsxs("h2",{children:["Productos seleccionados (",c.length,")"]})}),e.jsx("div",{className:"relative max-h-72 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-left text-xs text-neutral-600",children:[e.jsx("thead",{className:"bg-neutral-100 dark:bg-neutral-800 dark:text-neutral-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-1 text-left font-medium uppercase tracking-wider",children:"IVU"}),e.jsx("th",{className:"px-4 py-1 text-left font-medium uppercase tracking-wider",children:"Producto"}),e.jsx("th",{className:"px-4 py-1 text-left font-medium uppercase tracking-wider",children:"Cantidad"}),e.jsx("th",{className:"px-4 py-1 text-right font-medium uppercase tracking-wider"})]})}),e.jsx("tbody",{children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:e.jsx("div",{className:"flex justify-center bg-neutral-50 p-4 text-sm dark:bg-neutral-800 dark:text-neutral-300",children:e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{children:"No has seleccionado ningún producto :)"})})})})}):e.jsx(M,{children:c.map(t=>e.jsxs(k.tr,{initial:"hidden",animate:"visible",exit:"exit",variants:E,className:"border-b dark:text-neutral-300",children:[e.jsx("td",{className:"px-4 py-2",children:u(t.price_profit)}),e.jsx("td",{className:"truncate px-4 py-2",children:t.description}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"flex items-center space-x-0",children:[e.jsx("button",{type:"button",className:"rounded-l border border-neutral-300 bg-neutral-200 px-2 py-1.5 text-neutral-600 transition duration-200 hover:bg-neutral-300 hover:text-neutral-900 focus:outline-none dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-300",onClick:()=>g(t.code_product),children:e.jsx(we,{})}),e.jsx("input",{type:"number",min:"1",value:W[t.code_product]||"",onChange:r=>te(t.code_product,r.target.value),className:"hide-number-controls w-12 border-b border-t border-neutral-300 bg-white p-0.5 text-center text-sm focus:border-neutral-400 focus:ring-neutral-400 dark:border-neutral-700 dark:bg-neutral-700 dark:hover:bg-neutral-600"}),e.jsx("button",{type:"button",className:"rounded-r border border-neutral-300 bg-neutral-200 px-2 py-1.5 text-neutral-600 transition duration-200 hover:bg-neutral-300 hover:text-neutral-900 focus:outline-none dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-300 dark:hover:bg-neutral-600",onClick:()=>ae(t.code_product),children:e.jsx(Ce,{})})]})}),e.jsx("td",{className:"flex py-2 pr-4",children:e.jsx(k.button,{type:"button",className:"ml-2 rounded-md border border-red-300 bg-red-50 p-1.5 text-red-300 transition-colors duration-200 hover:bg-red-300 hover:text-red-50 dark:border-red-500 dark:bg-red-500",onClick:()=>n(t.code_product),variants:Y,whileHover:"hover",whileTap:"tap",children:e.jsx(Se,{})})})]},t.code_product))})})]})})]})]})}),e.jsx(M,{children:e.jsxs(k.div,{initial:"hidden",animate:"visible",exit:"hidden",variants:ie,className:"relative flex h-full max-h-max w-full max-w-2xl flex-col gap-y-5 rounded-xl border bg-white text-neutral-600 shadow-lg dark:border-neutral-700 dark:bg-neutral-900 dark:text-neutral-300",children:[e.jsxs("div",{className:"text-neutral-600 dark:text-neutral-300",children:[e.jsx("div",{className:"flex flex-row items-center gap-4 rounded-t-2xl border-b bg-neutral-50 px-4 py-3 text-lg font-semibold dark:bg-neutral-900",children:e.jsx("h2",{children:"Detalles de la compra"})}),e.jsx("div",{className:"max-h-52 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full table-auto divide-y divide-neutral-200 border-b text-xs dark:divide-neutral-700",children:[e.jsx("thead",{className:"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[160px] px-4 py-1 text-left font-medium uppercase tracking-wider",children:"Producto"}),e.jsx("th",{className:"px-4 py-1 text-left font-medium uppercase tracking-wider",children:"Cant"}),e.jsx("th",{className:"px-4 py-1 text-left font-medium uppercase tracking-wider",children:"IVU"}),e.jsx("th",{className:"px-4 py-1 text-right font-medium uppercase tracking-wider",children:"S/T"})]})}),e.jsx("tbody",{className:"divide-y divide-neutral-200 bg-white text-neutral-600 dark:divide-neutral-700 dark:bg-neutral-900 dark:text-neutral-300",children:c.length>0?c.map(t=>e.jsx(M,{children:e.jsxs(k.tr,{exit:"exit",initial:"hidden",animate:"visible",variants:E,transition:{duration:.3},children:[e.jsx("td",{className:"px-4 py-1",children:t.description}),e.jsx("td",{className:"px-4 py-1",children:t.amount}),e.jsx("td",{className:"px-4 py-1",children:u(t.price_profit)}),e.jsx("td",{className:"px-4 py-1 text-right font-semibold text-neutral-600 dark:text-neutral-300",children:u(t.amount*t.price_profit)})]})},t.code_product)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:e.jsx("div",{className:"flex justify-center bg-neutral-50 p-4 text-sm dark:bg-neutral-900 dark:text-neutral-300",children:e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{children:"No hay ningún producto en cola :)"})})})})})})]})})]}),e.jsxs("div",{className:"text-neutral-600 dark:text-neutral-300",children:[e.jsxs("div",{className:"px-4 text-xs font-medium",children:[e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{children:"Descuento"}),e.jsx("span",{className:"font-semibold",children:u(0)})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsxs("span",{className:"font-medium",children:["IVA ",N.iva,"%"]}),e.jsxs("span",{className:"font-semibold",children:["$",u(c.length>0?c.reduce((t,r)=>t+r.amount*r.price_profit,0)*(N.iva/100):0)]})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["$",u(c.reduce((t,r)=>t+r.amount*r.price_profit,0))]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between border-t border-dashed border-neutral-400 bg-neutral-100 px-4 py-2 text-xl font-semibold dark:bg-neutral-700 dark:text-neutral-300",children:[e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex w-full items-baseline justify-end gap-4",children:[e.jsx("span",{className:"text-sm font-medium uppercase",children:"Efectivo"}),e.jsxs("span",{className:parseFloat(p)<0||parseFloat(p)<x?"text-red-500":"text-green-500",children:["$",u(p)]})]}),e.jsxs("div",{className:"flex w-full items-baseline justify-end gap-4",children:[e.jsx("span",{className:"text-sm font-medium uppercase",children:"Cambio"}),e.jsxs("span",{className:I<0?"text-red-500":"",children:["$",u(I)]})]})]}),e.jsxs("div",{className:"flex items-baseline gap-4 dark:text-neutral-50",children:[e.jsx("span",{className:"text-base font-semibold uppercase",children:"Total a pagar"}),e.jsxs("span",{className:"text-3xl",children:["$",u(x)]})]})]})]}),ne&&e.jsxs("div",{className:"fixed bottom-3 right-3 z-40 mx-6 mb-12 transform rounded-lg border-2 bg-white p-4 shadow-lg dark:border-neutral-500 dark:bg-neutral-700 dark:text-neutral-300",children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("input",{type:"text",value:p,onChange:se,className:"w-48 rounded bg-neutral-700 px-3 py-1 text-right text-4xl font-bold text-green-200 outline-none dark:bg-neutral-800",placeholder:"0.00"})}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-2 text-xl font-bold",children:[["1","2","3","4","5","6","7","8","9","0","."].map(t=>e.jsx("button",{className:`rounded-lg border-2 border-neutral-300 bg-neutral-200 py-2 hover:bg-neutral-300 dark:border-neutral-600 dark:bg-neutral-800 ${re===t?"scale-105 transform shadow-lg transition-colors duration-200":""}`,onClick:()=>le(t),children:t},t)),e.jsx("button",{className:`rounded-lg bg-red-300 py-2 transition-colors duration-200 hover:bg-red-400 dark:bg-red-500 ${re==="C"?"scale-105 transform shadow-lg transition":""}`,onClick:he,children:"C"})]})]}),e.jsxs("div",{className:"text-md flex flex-row items-center justify-between gap-4 p-4",children:[e.jsx("button",{className:"rounded-lg bg-neutral-100 p-3 text-orange-400 transition-colors duration-200 hover:bg-neutral-200 dark:bg-neutral-700 dark:hover:bg-neutral-600",onClick:oe,children:ne?e.jsx(xe,{size:24}):e.jsx(Te,{size:24})}),e.jsxs("div",{className:"flex w-full items-center gap-4",children:[e.jsx(B,{onClick:ue,type:"button",variant:"secondary",size:"full",children:"Nueva venta"}),e.jsx(B,{onClick:de,type:"button",variant:"primary",size:"full",children:"Facturar"})]})]})]})]})})]})}),e.jsx(ze,{cash:p,change:I,formData:G,isOpen:Z,invoiceType:ee,onClose:pe,selectedProducts:c,onFinishSale:ue,handleInputChange:a,handleInvoiceTypeChange:h}),e.jsx(_e,{})]})};function He(){return e.jsx(Ae,{})}export{He as default};
