import{b5 as ge,a as be,r as i,j as e,A as I,m as k,I as je,b6 as ye,c as me,B as O,T as ve,w as L,b7 as Ne,aN as ke,Q as we,b8 as Ce,al as Se,ab as Te,b9 as _e,F as Le}from"./index-CwctY5k1.js";import{u as he}from"./useEconomic-Bn2vnqV6.js";import{E as Pe}from"./jspdf.plugin.autotable-CTNFFBrn.js";import{b as Ee}from"./date.util-DC23xNcO.js";import{d as Fe}from"./sale.api-BvUheGVx.js";import{f as x}from"./convertFloatToDecimal.util-4Gwe17GD.js";import{s as $e}from"./products.api-Dp8YqDK2.js";const ze=async()=>{try{return(await ge.get("/generate-ticket")).data}catch(N){throw new Error(`${N.response.data.message}`)}},Ae=({cash:N,isOpen:R,change:P,onClose:f,formData:d,invoiceType:ee,onFinishSale:B,selectedProducts:g,handleInputChange:$})=>{const{economic:te}=he(),{settings:m}=be(),[U,M]=i.useState(!1),[c,S]=i.useState(""),[w,C]=i.useState(!1),[y,z]=i.useState(ee),{formattedDate:q,formattedTime:G}=Ee(),K=async()=>{if(y)try{const b=await ze();S(b)}catch{}};i.useEffect(()=>{w&&(async()=>await K())()},[w,y]);const W=async()=>{M(!0);try{const n=new Pe({orientation:"p",unit:"mm",format:[80,130]});n.setFont("Courier","normal");const h=5;let r=10,J=n.internal.pageSize.height;const E=()=>{const u=r;u>J-20&&(n.addPage([80,u+20],"p"),J=n.internal.pageSize.height,r=10)};(()=>{n.setFontSize(12);const u=70;n.splitTextToSize(m==null?void 0:m.property_name,u).forEach(j=>{E(),n.text(j,40,r,null,null,"center"),r+=6}),n.setFontSize(8),n.splitTextToSize(m==null?void 0:m.address,u).forEach(j=>{E(),n.text(j,40,r,null,null,"center"),r+=4}),n.text(`RUC: ${m==null?void 0:m.ruc}`,40,r,null,null,"center"),r+=4,n.text(`Tel: ${m==null?void 0:m.phone}`,40,r,null,null,"center"),r+=6,n.text("*********** DOCUMENTO NO LEGAL ***********",40,r,null,null,"center"),r+=6,n.setFontSize(7),y==="business"?(n.text(`Ticket N°: ${c}`,h,r),r+=4,n.text("Fecha: "+q+" - "+G,h,r),r+=4,n.text(`Cliente: ${d.name}`,h,r),r+=4,n.text(`Cédula: ${d.idNumber}`,h,r),n.text(`Teléfono: ${d.phone}`,45,r),r+=4,n.text(`Correo: ${d.email}`,h,r),r+=6):y==="consumer"&&(n.text(`Ticket N°: ${c}`,h,r),r+=4,n.text("Fecha: "+q+" - "+G,h,r),r+=4,n.text("Cliente: Consumidor Final",h,r),r+=4,n.text("Cédula: 9999999999",h,r),n.text("Teléfono: 9999999999",45,r),r+=4,n.text("Correo: @",h,r),r+=6),n.text("------------------------------------------------",40,r,null,null,"center"),r+=3,n.setFontSize(6),n.text("Descripción",h,r),n.text("Cnt",55,r,null,null,"right"),n.text("PU",65,r,null,null,"right"),n.text("Total",75,r,null,null,"right"),r+=3,n.text("--------------------------------------------------------",40,r,null,null,"center"),r+=4,g.forEach(j=>{const Q=n.splitTextToSize(j.description,45);Q.forEach((Z,le)=>{E(),n.text(Z,h,r),le===Q.length-1&&(n.text(j.amount.toString(),55,r,null,null,"right"),n.text(x(j.price_profit),65,r,null,null,"right"),n.text(x(j.amount*j.price_profit),75,r,null,null,"right")),r+=3}),n.text("--------------------------------------------------------",40,r,null,null,"center"),r+=4})})();const V=g.reduce((u,_)=>u+_.amount*_.price_profit,0),A=V*(te.iva/100),Y=V+A;E(),n.text("Subtotal: "+x(V),75,r,null,null,"right"),r+=4,n.text("Impuestos: "+x(A),75,r,null,null,"right"),r+=4,n.text("TOTAL: "+x(Y),75,r,null,null,"right"),r+=4,n.text("Efectivo: "+x(N),75,r,null,null,"right"),r+=4,n.text("Cambio: "+x(P),75,r,null,null,"right"),r+=4,E(),n.text("Gracias por su compra!",45,r,null,null,"center"),n.save("recibo.pdf");const D=n.output("datauristring").split(",")[1],H={invoiceType:y,clients:[{name:d.name,phone:d.phone,identification_card:d.idNumber,email:d.email}],bills:[{id_ticket:c,bill_pdf:D,total:Y}],cash:N,change:P,products:g.map(u=>({id_product:u.id_product,amount:u.amount}))},p=await Fe(H);L({type:"success",message:p.message})}catch(b){L({type:"error",message:b.message})}M(!1)},T=b=>z(b.target.value),X=async()=>C(!0),ae=async()=>{await W(),B(),C(!1)},re=()=>C(!1);return R?e.jsxs(e.Fragment,{children:[e.jsx(I,{children:e.jsx(k.div,{className:"fixed inset-0 z-40 flex items-center justify-center overflow-auto bg-neutral-50/50 backdrop-blur-sm dark:bg-neutral-900/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:e.jsxs(k.div,{className:"relative flex w-full max-w-md flex-col gap-y-5 rounded-lg border bg-white p-4 shadow-lg dark:border-neutral-700 dark:bg-neutral-900",initial:{scale:.9},animate:{scale:1},exit:{scale:.9},transition:{duration:.3},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(je,{Icon:ye,text:"Facturación"}),e.jsx("div",{onClick:f,className:"cursor-pointer rounded-md p-1.5 text-lg text-neutral-400 transition-colors duration-150 hover:bg-neutral-100 hover:text-neutral-500 dark:hover:bg-neutral-800 dark:hover:text-neutral-300",children:e.jsx(me,{})})]}),e.jsxs("form",{onSubmit:b=>{b.preventDefault(),X()},className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-col gap-3 text-sm text-neutral-600 dark:text-neutral-300",children:[e.jsx("label",{className:"text-xs font-medium",children:"Tipo de factura"}),e.jsxs("select",{value:y,onChange:T,className:"block w-full rounded-lg border border-neutral-200 bg-white p-2 focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:bg-neutral-800",children:[e.jsx("option",{value:"consumer",children:"Consumidor final"}),e.jsx("option",{value:"business",children:"Factura con datos"})]}),y==="business"&&e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"text-xs font-medium",children:["Nombres",e.jsx("input",{type:"text",name:"name",required:!0,value:d.name,onChange:$,className:"mt-1 block w-full rounded-lg border border-neutral-200 bg-white p-2 focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:border-e-neutral-700 dark:bg-neutral-800"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex-1 text-xs font-medium",children:["Cédula",e.jsx("input",{type:"text",name:"idNumber",required:!0,value:d.idNumber,onChange:$,className:"mt-1 block w-full rounded-lg border border-neutral-200 bg-white p-2 focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:border-e-neutral-700 dark:bg-neutral-800"})]}),e.jsxs("label",{className:"flex-1 text-xs font-medium",children:["Teléfono",e.jsx("input",{type:"text",name:"phone",required:!0,value:d.phone,onChange:$,className:"mt-1 block w-full rounded-lg border border-neutral-200 bg-white p-2 focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:border-e-neutral-700 dark:bg-neutral-800"})]})]}),e.jsxs("label",{className:"text-xs font-medium",children:["Correo",e.jsx("input",{type:"email",name:"email",required:!0,value:d.email,onChange:$,className:"mt-1 block w-full rounded-lg border border-neutral-200 bg-white p-2 focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:border-e-neutral-700 dark:bg-neutral-800"})]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-4",children:[e.jsx(O,{onClick:f,variant:"outline",type:"outline",size:"md",children:"No, cancelar"}),e.jsx(O,{variant:"primary",type:"submit",size:"md",children:"Ok, procesar"})]})]}),e.jsx(I,{children:w&&e.jsx(k.div,{className:"fixed inset-0 z-50 flex items-center justify-center overflow-auto bg-neutral-50/90 backdrop-blur-sm dark:bg-neutral-900/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},children:e.jsx(k.div,{className:"relative flex w-full max-w-sm flex-col rounded-lg border bg-white p-4 shadow-lg dark:border-neutral-700 dark:bg-neutral-900",initial:{scale:.9},animate:{scale:1},exit:{scale:.9},transition:{duration:.3},children:e.jsxs("div",{className:"flex flex-col gap-y-4 font-medium text-neutral-600 dark:text-neutral-300",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Hey, espera!!"}),e.jsx("p",{className:"text-sm",children:"¿Estás seguro de que deseas confirma la compra y generar un ticket de venta?"}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(O,{onClick:re,variant:"outline",type:"button",size:"md",children:"No, cancelar"}),e.jsx(O,{onClick:ae,variant:"primary",type:"button",size:"md",loading:U,children:U?"Generando ticket...":"Ok, confirmar"})]})]})})})})]})})}),e.jsx(ve,{})]}):null},Ie=()=>{const{economic:N}=he(),[R,P]=i.useState([]),[f,d]=i.useState(""),[ee,B]=i.useState(!1),[g,$]=i.useState("barcode"),[te,m]=i.useState("consumer"),[U,M]=i.useState(!0),[c,S]=i.useState([]),[w,C]=i.useState([]),[y,z]=i.useState([]),q={name:"",phone:"",email:"",address:"",idNumber:""},[G,K]=i.useState(q),[W,T]=i.useState({});i.useEffect(()=>{(async()=>{if(f)try{M(!0);const a=await $e(f,g);Array.isArray(a)?(P(a),z(s=>[...s,...a])):a&&typeof a=="object"?(P([a]),z(s=>[...s,a])):(console.error("Unexpected response format:",a),P([]),z([]))}catch(a){console.error("Error fetching products:",a)}finally{M(!1)}})()},[f,g]),i.useEffect(()=>{if(!f){w.length>0&&C([]);return}const t=f.toLowerCase(),a=R.filter(s=>{var o,l;return g==="barcode"?((o=s.code_bar)==null?void 0:o.toLowerCase())===t:(l=s.description)==null?void 0:l.toLowerCase().includes(t)});a.length!==w.length&&C(a),a.length===1&&(X(a[0]),f!==""&&d(""))},[f,R,w,g]);const X=t=>{const a=y.find(s=>s.code_product===t.code_product);a&&S(s=>{const o=s.find(l=>l.code_product===t.code_product);if(o){const l=o.amount+1;if(l>a.amount)return L({type:"warning",message:`No puedes agregar más de ${a.amount} unidades de ${o.description}.`}),s;const F=s.map(v=>v.code_product===t.code_product?{...v,amount:l}:v);return T(v=>({...v,[t.code_product]:l})),F}else{if(1>a.amount)return s;const l={...t,amount:1},F=[...s,l];return T(v=>({...v,[t.code_product]:1})),F}})},ae=(t,a)=>{const s=Math.max(1,parseInt(a,10)),o=y.find(l=>l.code_product===t);if(o){if(s>o.amount){L({type:"warning",message:`No puedes agregar más de ${o.amount} unidades de ${o.description}.`});return}S(l=>l.map(v=>v.code_product===t?{...v,amount:s}:v)),T(l=>({...l,[t]:s}))}},re=t=>{const a=y.find(s=>s.code_product===t);a&&(S(s=>s.map(l=>{if(l.code_product===t){const F=l.amount+1;return F>a.amount?(L({type:"warning",message:`No puedes agregar más de ${a.amount} unidades de ${a.description}.`}),l):{...l,amount:F}}return l})),T(s=>{const l=(s[t]||1)+1;return l>a.amount?(L({type:"warning",message:`No puedes agregar más de ${a.amount} unidades de ${a.description}.`}),s):{...s,[t]:l}}))},b=t=>{S(a=>a.map(s=>s.code_product===t&&s.amount>1?{...s,amount:s.amount-1}:s)),T(a=>({...a,[t]:Math.max(1,(a[t]||1)-1)}))},n=t=>{S(a=>a.filter(s=>s.code_product!==t)),T(a=>{const{[t]:s,...o}=a;return o})},h=t=>m(t.target.value),r=t=>{const{name:a,value:s}=t.target;K(o=>({...o,[a]:s}))},J=t=>{d(""),C([]),X(t)},E=()=>{const t=["barcode","description","service"];$(a=>{const o=(t.indexOf(a)+1)%t.length;return t[o]}),d(""),P([]),C([])},ie={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0}},V={hidden:{opacity:0,x:20},visible:{opacity:1,x:0}},A={hidden:{opacity:0,y:-10},visible:{opacity:1,y:0,transition:{duration:.2,ease:"easeInOut"}},exit:{opacity:0,y:-10,transition:{duration:.2,ease:"easeInOut"}}},Y={hover:{scale:1.1,transition:{duration:.2}},tap:{scale:.9,transition:{duration:.2}}},[D,H]=i.useState(0),[p,u]=i.useState("0.00"),[_,ne]=i.useState(0),[j,se]=i.useState(null),[Q,Z]=i.useState(!1);i.useEffect(()=>{const t=c.reduce((o,l)=>o+l.amount*l.price_profit,0),a=t*(N.iva/100),s=t+a;if(ne(s),p&&parseFloat(p)>0){const o=parseFloat(p)||0;H(o-s)}else H(0)},[c,W,p,N.iva]);const le=t=>{const a=t.target.value;/^\d*\.?\d*$/.test(a)&&u(a)},pe=t=>{t==="."?p.includes(".")||u(a=>a+t):u(a=>a==="0.00"?t:a+t),se(t),setTimeout(()=>{se(null)},300)},fe=()=>u("0.00"),oe=()=>{Z(t=>!t)};i.useEffect(()=>{const t=a=>{a.ctrlKey&&a.code==="Space"&&oe(),a.code==="Escape"&&Z(!1)};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[]);const de=()=>{if(c.length===0){L({type:"warning",message:"No hay productos seleccionados."});return}else if(parseFloat(p)<_){L({type:"error",message:"EL efectivo es menor que el total a pagar."});return}B(!0)},ce=t=>{t.ctrlKey&&t.key==="Enter"?de():t.key==="Escape"&&ue()};i.useEffect(()=>(window.addEventListener("keydown",ce),()=>{window.removeEventListener("keydown",ce)}),[c,p,_]);const ue=()=>B(!1),xe=()=>{S([]),C([]),z([]),K(q),u("0.00"),H(0),ne(0),B(!1)};return e.jsxs("main",{className:"mx-auto pt-20",children:[e.jsx(Ne,{}),e.jsx("div",{className:"relative mx-auto w-full max-w-7xl items-center py-2 text-neutral-500 dark:text-neutral-300 md:px-9 lg:px-2",children:e.jsxs("div",{className:"mx-auto grid w-full grid-cols-1 gap-8 pb-16 lg:grid-cols-2",children:[e.jsx(I,{children:e.jsxs(k.div,{initial:"hidden",animate:"visible",exit:"hidden",variants:ie,children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("div",{className:"flex flex-row items-center gap-4 pb-4 text-lg font-semibold",children:e.jsx("h2",{children:"Productos"})}),e.jsxs("div",{className:"flex flex-row items-center justify-between pb-4",children:[e.jsxs("button",{className:"rounded-md border bg-neutral-50 px-4 py-2 text-sm dark:border-neutral-700 dark:bg-neutral-800",onClick:E,children:["Buscar por ","",g==="barcode"?"descripción producto":g==="description"?"servicio Digital":"código de Barra"]}),e.jsxs("div",{className:"relative flex w-auto items-center text-sm dark:bg-neutral-800",children:[e.jsx("input",{type:"text",value:f,onChange:t=>d(t.target.value),placeholder:`Buscar por ${g==="barcode"?"código de barra":g==="description"?"descripción":g==="service"?"servicio digital":""}`,className:"w-full rounded-md border p-2 px-4 pl-10 font-medium shadow-sm focus:outline-none focus:ring-1 focus:ring-neutral-500 dark:border-neutral-700 dark:bg-neutral-800","aria-label":"Campo de búsqueda"}),e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center rounded-l-lg border border-r-transparent pl-3 dark:border-neutral-700 dark:border-r-neutral-800 dark:bg-neutral-800",children:e.jsx(ke,{size:18})})]})]}),U&&f!==""?e.jsx("div",{className:"} flex justify-center bg-neutral-50 p-4 text-sm",children:e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{children:"Buscando coincidencias..."})})}):f===""?e.jsx("div",{className:"flex justify-center bg-neutral-50 p-4 text-sm dark:bg-neutral-800",children:e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{children:"No has buscado ningún producto :("})})}):e.jsx("div",{className:"max-h-[calc(3*3.2rem)] space-y-2 overflow-y-auto",children:w.length>0?w.map(t=>e.jsxs(k.div,{initial:"hidden",animate:"visible",exit:"exit",variants:A,transition:{duration:.3},className:"mr-2 flex items-center justify-between bg-neutral-100/70 transition-colors duration-150 hover:bg-neutral-400 hover:text-neutral-50 dark:bg-neutral-800",children:[e.jsx("div",{className:"flex-1 border-l-4 border-neutral-400 px-3 py-2",children:e.jsx("h3",{className:"truncate text-xs font-medium",children:t.description})}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 bg-neutral-500 p-2 text-xs font-medium text-neutral-100 transition-colors duration-150 hover:bg-neutral-100/80 hover:text-neutral-600",onClick:()=>J(t),children:[e.jsx(we,{size:14}),e.jsx("span",{children:"Añadir"})]})]},t.code_product)):e.jsx("div",{className:"flex justify-center bg-orange-50 p-4 text-sm text-orange-400 dark:bg-neutral-800",children:e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{children:"No se encontraron coincidencias :("})})})})]}),e.jsxs("div",{className:"flex flex-col pt-8",children:[e.jsx("div",{className:"flex flex-row items-center justify-between pb-2 text-base font-semibold",children:e.jsxs("h2",{children:["Productos seleccionados (",c.length,")"]})}),e.jsx("div",{className:"relative max-h-72 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-left text-xs text-neutral-600",children:[e.jsx("thead",{className:"bg-neutral-100 dark:bg-neutral-800 dark:text-neutral-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-1 text-left font-medium uppercase tracking-wider",children:"IVU"}),e.jsx("th",{className:"px-4 py-1 text-left font-medium uppercase tracking-wider",children:"Producto"}),e.jsx("th",{className:"px-4 py-1 text-left font-medium uppercase tracking-wider",children:"Cantidad"}),e.jsx("th",{className:"px-4 py-1 text-right font-medium uppercase tracking-wider"})]})}),e.jsx("tbody",{children:c.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:e.jsx("div",{className:"flex justify-center bg-neutral-50 p-4 text-sm dark:bg-neutral-800 dark:text-neutral-300",children:e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{children:"No has seleccionado ningún producto :)"})})})})}):e.jsx(I,{children:c.map(t=>e.jsxs(k.tr,{initial:"hidden",animate:"visible",exit:"exit",variants:A,className:"border-b dark:text-neutral-300",children:[e.jsx("td",{className:"px-4 py-2",children:x(t.price_profit)}),e.jsx("td",{className:"truncate px-4 py-2",children:t.description}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"flex items-center space-x-0",children:[e.jsx("button",{type:"button",className:"rounded-l border border-neutral-300 bg-neutral-200 px-2 py-1.5 text-neutral-600 transition duration-200 hover:bg-neutral-300 hover:text-neutral-900 focus:outline-none dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-300",onClick:()=>b(t.code_product),children:e.jsx(Ce,{})}),e.jsx("input",{type:"number",min:"1",value:W[t.code_product]||"",onChange:a=>ae(t.code_product,a.target.value),className:"hide-number-controls w-12 border-b border-t border-neutral-300 bg-white p-0.5 text-center text-sm focus:border-neutral-400 focus:ring-neutral-400 dark:border-neutral-700 dark:bg-neutral-700 dark:hover:bg-neutral-600"}),e.jsx("button",{type:"button",className:"rounded-r border border-neutral-300 bg-neutral-200 px-2 py-1.5 text-neutral-600 transition duration-200 hover:bg-neutral-300 hover:text-neutral-900 focus:outline-none dark:border-neutral-700 dark:bg-neutral-800 dark:text-neutral-300 dark:hover:bg-neutral-600",onClick:()=>re(t.code_product),children:e.jsx(Se,{})})]})}),e.jsx("td",{className:"flex py-2 pr-4",children:e.jsx(k.button,{type:"button",className:"ml-2 rounded-md border border-red-300 bg-red-50 p-1.5 text-red-300 transition-colors duration-200 hover:bg-red-300 hover:text-red-50 dark:border-red-500 dark:bg-red-500",onClick:()=>n(t.code_product),variants:Y,whileHover:"hover",whileTap:"tap",children:e.jsx(Te,{})})})]},t.code_product))})})]})})]})]})}),e.jsx(I,{children:e.jsxs(k.div,{initial:"hidden",animate:"visible",exit:"hidden",variants:V,className:"relative flex h-full max-h-max w-full max-w-2xl flex-col gap-y-5 rounded-xl border bg-white text-neutral-600 shadow-lg dark:border-neutral-700 dark:bg-neutral-900 dark:text-neutral-300",children:[e.jsxs("div",{className:"text-neutral-600 dark:text-neutral-300",children:[e.jsx("div",{className:"flex flex-row items-center gap-4 rounded-t-2xl border-b bg-neutral-50 px-4 py-3 text-lg font-semibold dark:bg-neutral-900",children:e.jsx("h2",{children:"Detalles de la compra"})}),e.jsx("div",{className:"max-h-52 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full table-auto divide-y divide-neutral-200 border-b text-xs dark:divide-neutral-700",children:[e.jsx("thead",{className:"bg-neutral-100 text-neutral-600 dark:bg-neutral-800 dark:text-neutral-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[160px] px-4 py-1 text-left font-medium uppercase tracking-wider",children:"Producto"}),e.jsx("th",{className:"px-4 py-1 text-left font-medium uppercase tracking-wider",children:"Cant"}),e.jsx("th",{className:"px-4 py-1 text-left font-medium uppercase tracking-wider",children:"IVU"}),e.jsx("th",{className:"px-4 py-1 text-right font-medium uppercase tracking-wider",children:"S/T"})]})}),e.jsx("tbody",{className:"divide-y divide-neutral-200 bg-white text-neutral-600 dark:divide-neutral-700 dark:bg-neutral-900 dark:text-neutral-300",children:c.length>0?c.map(t=>e.jsx(I,{children:e.jsxs(k.tr,{exit:"exit",initial:"hidden",animate:"visible",variants:A,transition:{duration:.3},children:[e.jsx("td",{className:"px-4 py-1",children:t.description}),e.jsx("td",{className:"px-4 py-1",children:t.amount}),e.jsx("td",{className:"px-4 py-1",children:x(t.price_profit)}),e.jsx("td",{className:"px-4 py-1 text-right font-semibold text-neutral-600 dark:text-neutral-300",children:x(t.amount*t.price_profit)})]})},t.code_product)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center",children:e.jsx("div",{className:"flex justify-center bg-neutral-50 p-4 text-sm dark:bg-neutral-900 dark:text-neutral-300",children:e.jsx("div",{className:"flex flex-row items-center gap-2",children:e.jsx("span",{children:"No hay ningún producto en cola :)"})})})})})})]})})]}),e.jsxs("div",{className:"text-neutral-600 dark:text-neutral-300",children:[e.jsxs("div",{className:"px-4 text-xs font-medium",children:[e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{children:"Descuento"}),e.jsx("span",{className:"font-semibold",children:x(0)})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsxs("span",{className:"font-medium",children:["IVA ",N.iva,"%"]}),e.jsxs("span",{className:"font-semibold",children:["$",x(c.length>0?c.reduce((t,a)=>t+a.amount*a.price_profit,0)*(N.iva/100):0)]})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Subtotal"}),e.jsxs("span",{className:"font-semibold",children:["$",x(c.reduce((t,a)=>t+a.amount*a.price_profit,0))]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between border-t border-dashed border-neutral-400 bg-neutral-100 px-4 py-2 text-xl font-semibold dark:bg-neutral-700 dark:text-neutral-300",children:[e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex w-full items-baseline justify-end gap-4",children:[e.jsx("span",{className:"text-sm font-medium uppercase",children:"Efectivo"}),e.jsxs("span",{className:parseFloat(p)<0||parseFloat(p)<_?"text-red-500":"text-green-500",children:["$",x(p)]})]}),e.jsxs("div",{className:"flex w-full items-baseline justify-end gap-4",children:[e.jsx("span",{className:"text-sm font-medium uppercase",children:"Cambio"}),e.jsxs("span",{className:D<0?"text-red-500":"",children:["$",x(D)]})]})]}),e.jsxs("div",{className:"flex items-baseline gap-4 dark:text-neutral-50",children:[e.jsx("span",{className:"text-base font-semibold uppercase",children:"Total a pagar"}),e.jsxs("span",{className:"text-3xl",children:["$",x(_)]})]})]})]}),Q&&e.jsxs("div",{className:"fixed bottom-3 right-3 z-40 mx-6 mb-12 transform rounded-lg border-2 bg-white p-4 shadow-lg dark:border-neutral-500 dark:bg-neutral-700 dark:text-neutral-300",children:[e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("input",{type:"text",value:p,onChange:le,className:"w-48 rounded bg-neutral-700 px-3 py-1 text-right text-4xl font-bold text-green-200 outline-none dark:bg-neutral-800",placeholder:"0.00"})}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-2 text-xl font-bold",children:[["1","2","3","4","5","6","7","8","9","0","."].map(t=>e.jsx("button",{className:`rounded-lg border-2 border-neutral-300 bg-neutral-200 py-2 hover:bg-neutral-300 dark:border-neutral-600 dark:bg-neutral-800 ${j===t?"scale-105 transform shadow-lg transition-colors duration-200":""}`,onClick:()=>pe(t),children:t},t)),e.jsx("button",{className:`rounded-lg bg-red-300 py-2 transition-colors duration-200 hover:bg-red-400 dark:bg-red-500 ${j==="C"?"scale-105 transform shadow-lg transition":""}`,onClick:fe,children:"C"})]})]}),e.jsxs("div",{className:"text-md flex flex-row items-center justify-between gap-4 p-4",children:[e.jsx("button",{className:"rounded-lg bg-neutral-100 p-3 text-orange-400 transition-colors duration-200 hover:bg-neutral-200 dark:bg-neutral-700 dark:hover:bg-neutral-600",onClick:oe,children:Q?e.jsx(me,{size:24}):e.jsx(_e,{size:24})}),e.jsxs("div",{className:"flex w-full items-center gap-4",children:[e.jsx(O,{onClick:xe,type:"button",variant:"secondary",size:"full",children:"Nueva venta"}),e.jsx(O,{onClick:de,type:"button",variant:"primary",size:"full",children:"Facturar"})]})]})]})]})})]})}),e.jsx(Ae,{cash:p,change:D,formData:G,isOpen:ee,invoiceType:te,onClose:ue,selectedProducts:c,onFinishSale:xe,handleInputChange:r,handleInvoiceTypeChange:h}),e.jsx(Le,{})]})};function Qe(){return e.jsx(Ie,{})}export{Qe as default};
