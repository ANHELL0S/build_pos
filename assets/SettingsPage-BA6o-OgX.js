import{$ as A,a0 as V,a1 as G,j as e,r as c,A as O,m as z,Z as _,B as b,a2 as T,w as p,a as U,S as w,I as C,a3 as J,a4 as Q,a5 as Z,a6 as W,a7 as H,a8 as K,C as X,E as Y,o as ee,a9 as ae,aa as se,ab as te,ac as re,ad as ne}from"./index-D8Kk0eQ9.js";import{z as h,u as $,t as P}from"./index-B3hE7uB9.js";import{u as oe,a as le}from"./useEconomic-B4EkMvvB.js";import{I as v}from"./InputFieldZod-BkV1CeP7.js";const ie=a=>typeof a!="number"||isNaN(a)||a<0?"N/A":`${(a/1048576).toFixed(2)} MB`,ce=h.object({property_name:h.string({required_error:"Nombre de la propiedad  es requerido."}).min(6,"Mínimo 6 caracteres").max(250,"Máximo 250 caracteres"),address:h.string({required_error:"Dirección es requerida."}).min(5,"Mínimo 5 caracteres").max(250,"Máximo 250 caracteres"),ruc:h.string({required_error:"Número de celular es requerido."}).min(13,"Mínimo 13 caracteres").max(13,"Máximo 13 caracteres"),email:h.string({required_error:"Email es requerido."}).email("Correo electrónico no válido"),phone:h.string({required_error:"Número de celular es requerido."}).min(10,"Mínimo 10 caracteres").max(10,"Máximo 10 caracteres")}),de=h.object({iva:h.string({required_error:"IVA es requerido."}).min(1,"Mínimo 1 caracteres").max(3,"Máximo 3 caracteres"),alert_stock:h.string({required_error:"Alerta de stock bajos es requerido."}).min(1,"Mínimo 1 caracteres").max(3,"Máximo 13 caracteres"),profit_percentage:h.string({required_error:"Procentaje de ganancia es requerido."}).min(1,"Mínimo 1 caracteres").max(2,"Máximo 2 caracteres")}),me=async()=>{try{return(await A.get("/")).data}catch(a){throw new Error(`${a.response.data.message}`)}},ue=async a=>{try{return(await A.post("/",a)).data}catch(s){throw new Error(`${s.response.data.message}`)}},xe=async a=>{try{return(await A.delete(`/${a}`)).data}catch(s){throw new Error(`${s.response.data.message}`)}},pe=V(a=>({backups:[],loadingBackups:!1,fetchBackups:async()=>{a({loadingBackups:!0});try{const s=await me();a({backups:s.data_backup.backup})}catch{}finally{a({loadingBackups:!1})}},addBackup:s=>{a(r=>({backups:[...r.backups,s]}))}})),ge=async a=>{try{return(await G.post("/",a)).data}catch(s){throw new Error(`${s.response.data.message}`)}},fe=({text:a,style:s})=>e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center bg-neutral-50 ${s||"min-h-screen"} bg-white dark:bg-neutral-900`,children:e.jsx("div",{className:"flex flex-col",children:e.jsx("div",{className:"flex space-x-24",children:e.jsx("div",{className:"container relative space-y-10",children:e.jsxs("div",{className:"flex flex-col items-center text-neutral-600 dark:text-neutral-300",children:[e.jsxs("div",{className:"flex flex-row items-center justify-center space-x-2 pb-2",children:[e.jsx("div",{className:"h-5 w-5 animate-bounce rounded-full bg-neutral-300 [animation-delay:-0.3s]"}),e.jsx("div",{className:"h-5 w-5 animate-bounce rounded-full bg-neutral-300 [animation-delay:-0.15s]"}),e.jsx("div",{className:"h-5 w-5 animate-bounce rounded-full bg-neutral-300"})]}),e.jsx("span",{className:"text-md pt-6 font-medium",children:a||"Por favor, espera un momento."})]})})})})}),F=({text:a,loading:s,onClose:r,onSubmit:x,styles:t,type_variant:d,messages_info:m})=>{const[l,o]=c.useState(!1);c.useEffect(()=>{o(!0)},[]);const f={hidden:{opacity:0,backdropFilter:"blur(0px)"},visible:{opacity:1,backdropFilter:"blur(2px)",transition:{duration:.2}}},g={hidden:{opacity:0,scale:.9,transition:{duration:.2,ease:"easeOut"}},visible:{opacity:1,scale:1,transition:{duration:.2,type:"spring",stiffness:600,damping:30}}};return e.jsx(O,{children:l&&e.jsxs(z.div,{className:"fixed inset-0 z-50 flex items-center justify-center overflow-auto",initial:"hidden",animate:"visible",exit:"hidden",variants:f,children:[e.jsx(z.div,{className:"absolute inset-0 bg-neutral-50/50 dark:bg-neutral-900/50",variants:f}),e.jsx(z.div,{className:"relative flex w-full max-w-md flex-col items-end justify-center p-4 text-center sm:block sm:p-0",variants:g,onClick:u=>u.stopPropagation(),children:e.jsxs("div",{className:"transform space-y-4 rounded-lg border bg-white p-4 text-left align-bottom text-neutral-500 shadow-lg transition-all dark:border-neutral-700 dark:bg-neutral-900 dark:text-neutral-300 sm:inline-block sm:w-full sm:max-w-md sm:align-middle",children:[e.jsx("div",{className:"flex flex-row items-center font-medium text-neutral-600",children:e.jsx("span",{className:`${t.text} text-lg`,children:a.title})}),e.jsx(_,{messages:m,variant:d}),e.jsxs("p",{className:"text-sm",children:[a.description_a," ",e.jsx("strong",{children:a.description_b})," ",a.description_c]}),e.jsxs("div",{className:"flex justify-end gap-4 text-xs",children:[!s&&e.jsx(b,{onClick:()=>{o(!1),setTimeout(r,300)},type:"button",variant:"outline",size:"md",children:a.buttonCancel}),e.jsx("button",{type:"button",onClick:x,disabled:s,className:`inline-flex justify-center rounded-md px-4 ${t.buttonSubmit} items-center font-semibold text-neutral-50 transition-colors duration-200 ${t.hoverButtonSubmit} focus:outline-none sm:mt-0 ${s?"cursor-not-allowed":""}`,children:s?e.jsx(T,{loadingText:"Procesando..."}):a.buttonSubmit})]})]})})]})})},he=({backup:a,onClose:s,onDelete:r})=>{const[x,t]=c.useState(!1),d=async l=>{l.preventDefault(),t(!0);try{const o=await xe(a.backup_number);p({type:"success",message:o.message}),s(),r()}catch(o){p({type:"error",message:o.message})}finally{t(!1)}},m={text:{title:"Eliminar respaldo",description_a:"Estás a punto de eliminar el respaldo ",description_b:`${a.backup_name}`,description_c:"¿Está seguro?",buttonCancel:"No, mantenlo",buttonSubmit:"Ok, eliminalo"},messages_info:["Esta acción eliminará el respaldo de datos seleccionado.","Si se procede, todos los datos asociados a este respaldo que ya están registrados en el sistema se perderán.","Una vez eliminado, no podrás recuperar este respaldo, así que asegúrate de que realmente deseas continuar."],type_variant:"error",styles:{background:"bg-red-100",text:"text-red-500",buttonSubmit:"bg-red-500",hoverButtonSubmit:"hover:bg-red-600"},loading:x,onClose:s,onSubmit:d};return e.jsx(F,{...m})},be=({backup:a,onClose:s,onRestore:r})=>{const[x,t]=c.useState(!1),d=async l=>{l.preventDefault(),t(!0);try{const o=await ge({data_backup:a.backup_number});p({type:"success",message:o.message}),s(),r()}catch(o){p({type:"error",message:o.message})}finally{t(!1)}},m={text:{title:"Restaurar registros",description_a:"Estás a punto de restaurar los registros con el respaldo ",description_b:`${a.backup_name}`,description_c:"¿Está seguro?",buttonCancel:"No, mantenlo",buttonSubmit:"Ok, restaurar"},messages_info:["Esta acción restaurará el respaldo de datos seleccionado.","Si se procede, los datos asociados a este respaldo serán restaurados en el sistema, reemplazando cualquier información existente.","Asegúrate de que deseas continuar, ya que esta acción no se puede deshacer."],type_variant:"success",styles:{background:"bg-emerald-100",text:"text-emerald-500",buttonSubmit:"bg-emerald-500",hoverButtonSubmit:"hover:bg-emerald-600"},loading:x,onClose:s,onSubmit:d};return e.jsx(F,{...m})},je=()=>{const[a,s]=c.useState("Sistema"),{settings:r,loading:x,error:t}=U(),{economic:d,loading:m,error:l}=oe(),o=()=>{if(x)return e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(w,{text:"Cargando datos del local, espera un momento :)"})});if(t)return e.jsx("div",{className:"text-red-500",children:"Error loading settings."});switch(a){case"Sistema":return r?e.jsx(ve,{settings:r}):e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(w,{text:"Cargando datos del local, espera un momento :)"})});case"Economico":return d?e.jsx(ye,{economic:d}):e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsx(w,{text:"Cargando datos económicos, espera un momento :)"})});case"Respaldo":return e.jsx(ke,{});default:return null}};return e.jsx("main",{className:"mx-auto max-w-7xl py-20 pt-24",children:e.jsxs("div",{className:"flex flex-col gap-4 lg:flex-col",children:[e.jsx("div",{className:"fixed left-0 top-16 z-30 mt-0 w-full bg-white dark:bg-neutral-100",children:e.jsx("ul",{className:"flex flex-row items-center justify-start gap-0 bg-white p-6 text-sm font-medium text-neutral-400 dark:bg-neutral-900 dark:text-neutral-400",children:e.jsxs("div",{className:"flex items-center rounded-lg bg-neutral-200 p-1 dark:bg-neutral-800",children:[e.jsx("li",{onClick:()=>s("Sistema"),className:`cursor-pointer ${a==="Sistema"?"rounded-md bg-neutral-100 px-4 py-1 text-neutral-500 dark:bg-neutral-700 dark:text-neutral-300":"px-4"}`,children:"Establecimiento"}),e.jsx("li",{onClick:()=>s("Economico"),className:`cursor-pointer ${a==="Economico"?"rounded-md bg-neutral-100 px-4 py-1 text-neutral-500 dark:bg-neutral-700 dark:text-neutral-300":"px-4"}`,children:"Económico"}),e.jsx("li",{onClick:()=>s("Respaldo"),className:`cursor-pointer ${a==="Respaldo"?"rounded-md bg-neutral-100 px-4 py-1 text-neutral-500 dark:bg-neutral-700 dark:text-neutral-300":"px-4"}`,children:"Respaldo"})]})})}),e.jsx("div",{className:"flex w-full flex-col pt-16",children:o()})]})})},ve=({settings:a})=>{const s={ruc:a.ruc||"",email:a.email||"",phone:a.phone||"",image:a.image||"",address:a.address||"",property_name:a.property_name||""},{register:r,handleSubmit:x,formState:{errors:t},reset:d}=$({resolver:P(ce),defaultValues:s}),[m,l]=c.useState(!1),[o,f]=c.useState(!1),[g,u]=c.useState(null),[y,N]=c.useState(!1),k=async i=>{l(!0);try{const j=await re(a.id_setting,i);p({type:"success",message:j.message})}catch(j){p({type:"error",message:j.message})}finally{l(!1)}},E=async()=>{if(event.preventDefault(),!g){p({type:"error",message:"Por favor selecciona tu logo."});return}if(g){f(!0);try{const i=await ne(a.id_setting,g);p({type:"success",message:i.message}),u(null),setTimeout(()=>window.location.reload(),100)}catch(i){p({type:"error",message:i.message})}finally{f(!1)}}},L=["Nombre del establecimiento: Nombre oficial del negocio.","Dirección: Ubicación física del establecimiento.","RUC: Registro Único de Contribuyentes, número identificativo fiscal.","Correo electrónico: E-mail de contacto para comunicaciones de los clientes.","Recuerda que estos datos se mostrarán en el ticket de venta."],S=["El logo aparecerá en otras secciones como el encabezado de facturas, recibos de compra, en el sitio web del establecimiento, en correos electrónicos promocionales, tarjetas de presentación digitales y menús en línea."],I=i=>{const j=i.target.files[0];u(j)},B=i=>{i.preventDefault(),N(!1);const j=i.dataTransfer.files[0];j&&u(j)},D=i=>i.preventDefault(),q=()=>N(!0),M=()=>N(!1),R=()=>u(null),n=()=>document.getElementById("file-input").click();return e.jsx("div",{className:"text-md flex gap-12 text-neutral-500 dark:text-neutral-300",children:e.jsxs("div",{className:"flex w-full gap-10",children:[e.jsxs("form",{className:"flex w-1/2 flex-col gap-y-6 text-sm",onSubmit:x(k),children:[e.jsxs("div",{className:"flex flex-col gap-4 text-xs font-medium",children:[e.jsxs("div",{className:"flex flex-col gap-6 text-sm",children:[e.jsx(C,{Icon:J,text:"Datos del establecimiento"}),e.jsx(_,{title:"Información",messages:L,variant:"info"})]}),e.jsx(v,{error:t.property_name,label:"Nombre del establecimiento",register:r("property_name"),placeholder:"Nombre del establecimiento"}),e.jsx(v,{error:t.address,register:r("address"),label:"Dirección del establecimiento",placeholder:"Dirección del establecimiento"}),e.jsxs("div",{className:"grid grid-cols-3 gap-x-4 gap-y-3 pt-2 font-medium",children:[e.jsx(v,{error:t.ruc,label:"RUC",register:r("ruc"),placeholder:"RUC"}),e.jsx(v,{error:t.email,label:"E-mail",register:r("email"),placeholder:"E-mail"}),e.jsx(v,{error:t.phone,label:"Celular",register:r("phone"),placeholder:"Celular"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{onClick:()=>d(s),variant:"outline",size:"md",children:"Cancelar"}),e.jsx(b,{variant:"primary",type:"submit",size:"md",loading:m,children:m?"Guardando...":"Guardar cambios"})]})]}),e.jsxs("form",{className:"flex w-1/2 flex-col gap-y-6 text-sm",onSubmit:E,children:[e.jsxs("div",{className:"flex flex-col gap-6 text-sm",children:[e.jsx(C,{Icon:Q,text:"Logo del establecimiento"}),e.jsx(_,{title:"Información",messages:S,variant:"info"}),e.jsx("label",{className:"text-xs font-medium",children:"Logo actual"}),e.jsx("img",{src:a.image,alt:"Logo del establecimiento",className:"h-36 w-full rounded-lg border object-contain p-4 dark:border-neutral-700"}),e.jsxs("div",{className:`flex w-auto flex-col gap-4 ${y?"border-blue-500":""}`,onDragOver:D,onDragEnter:q,onDragLeave:M,onDrop:B,children:[e.jsx("label",{className:"text-xs font-medium",children:"Seleccionar logo"}),e.jsxs("div",{className:`border-neutral-00 flex w-full flex-col items-center justify-center rounded-xl border-2 border-dashed bg-white p-6 text-center transition duration-150 ease-in-out hover:bg-gray-50 dark:border-neutral-700 dark:bg-neutral-900 dark:text-neutral-300 ${y?"bg-gray-100 dark:bg-gray-700":""}`,children:[g?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex w-full items-center justify-between text-neutral-500 dark:border-neutral-700 dark:text-neutral-300",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{size:20}),e.jsx("p",{className:"ml-2 text-sm font-medium",children:g.name})]}),e.jsx("button",{type:"button",onClick:R,className:"flex items-center justify-center rounded-full p-3 text-neutral-500 transition-colors duration-150 hover:bg-red-100 hover:text-red-400 dark:hover:bg-red-800/60 dark:hover:text-red-300",children:e.jsx(W,{})})]})}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("h2",{className:"mt-4 text-xl font-medium tracking-wide",children:y?"Suelta el archivo aquí":"Seleccionar Logo"}),e.jsx("p",{className:"mt-2 tracking-wide",children:y?"Suelta el archivo para cargarlo":"Arrastre y suelte su archivo (PNG, JPG o JPEG)."}),e.jsx("p",{className:"mt-2 cursor-pointer text-sky-500 underline hover:text-sky-600",onClick:n,children:"O selecciona tu imagen"})]}),e.jsx("input",{id:"file-input",type:"file",className:"hidden",accept:"image/png, image/jpeg, image/jpg",onChange:I})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{onClick:()=>u(null),variant:"outline",size:"md",children:"Cancelar"}),e.jsx(b,{variant:"primary",type:"submit",size:"md",loading:o,children:o?"Subiendo...":"Subir logo"})]})]})]})})},ye=({economic:a})=>{const s={iva:a.iva||"",alert_stock:a.alert_stock||"",profit_percentage:a.profit_percentage||""},{register:r,handleSubmit:x,formState:{errors:t},reset:d}=$({resolver:P(de),defaultValues:s}),[m,l]=c.useState(!1),o=async g=>{l(!0);try{const u=await le(a.id_economic,g);p({type:"success",message:u.message})}catch(u){p({type:"error",message:u.message})}finally{l(!1)}},f=["IVA (Impuesto al Valor Agregado): El porcentaje actual de IVA aplicado es del 15%","Porcentaje de ganancia: El porcentaje de ganancia establecido por el negocio es del 8% por defecto. Este margen de ganancia se aplica sobre el costo total de los productos o servicios, y es crucial para asegurar la rentabilidad del negocio.","Alerta bajo stock: El número de unidades minimas para mostrar la alerta en tiempo real."];return e.jsx("div",{className:"text-md text-neutral-500 dark:text-neutral-300",children:e.jsx("div",{className:"transform text-left align-bottom transition-all",children:e.jsxs("form",{className:"flex flex-col gap-y-6 text-sm",onSubmit:x(o),children:[e.jsx(C,{Icon:H,text:"Ajuste económico"}),e.jsx(_,{title:"Información",messages:f,variant:"info"}),e.jsxs("div",{className:"grid grid-cols-4 gap-x-4 gap-y-3 pt-2 text-xs font-medium",children:[e.jsx(v,{type:"text",error:t.iva,label:"IVA",register:r("iva"),placeholder:"IVA"}),e.jsx(v,{type:"text",label:"Porcentaje de ganancia",error:t.profit_percentage,placeholder:"Porcentaje de ganancia",register:r("profit_percentage")}),e.jsx(v,{type:"text",error:t.alert_stock,label:"Alerta bajo stock",register:r("alert_stock"),placeholder:"Alerta bajo stock"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(b,{onClick:()=>d(s),variant:"outline",size:"md",children:"Cancelar"}),e.jsx(b,{variant:"primary",type:"submit",size:"md",loading:m,children:m?"Guardando...":"Guardar cambios"})]})]})})})},ke=()=>{const[a,s]=c.useState(""),[r,x]=c.useState(""),[t,d]=c.useState(!1),[m,l]=c.useState(null),[o,f]=c.useState(!1),[g,u]=c.useState(!1),{backups:y,loadingBackups:N,fetchBackups:k,addBackup:E}=pe(),L=async()=>{event.preventDefault(),d(!0);try{const n=await ue({name:r});p({type:"success",message:n.message});const i=n.data_backup.backup[0];x(""),E({backup_number:i.backup_number,date_backup:i.date_backup,size:i.size,backup_name:i.backup_name})}catch(n){p({type:"error",message:n.message})}finally{d(!1)}};c.useEffect(()=>{k()},[k]);const S=y.filter(n=>n.backup_name.toLowerCase().includes(a.toLowerCase())),I=n=>{l(n),u(!0)},B=()=>u(!g),D=async()=>{k(),u(!1),l(null)},q=n=>{l(n),f(!0)},M=()=>f(!o),R=async()=>{k(),f(!1),l(null)};return e.jsxs("main",{className:"flex flex-col items-center bg-white dark:bg-neutral-900",children:[e.jsxs("section",{className:"w-full",children:[e.jsxs("form",{onSubmit:L,className:"space-y-4 text-xs",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Crear respaldo"}),e.jsx("input",{type:"text",value:r,onChange:n=>x(n.target.value),className:"w-full rounded-md border p-2 text-sm focus:outline-none focus:ring-1 focus:ring-neutral-400 dark:border-neutral-700 dark:bg-neutral-800 dark:focus:ring-neutral-700",placeholder:"Nombre del respaldo"}),e.jsx("div",{className:"flex justify-end space-x-2",children:e.jsx(b,{type:"submit",variant:"primary",loading:t,size:"md",children:t?"Creando...":"Crear respaldo"})})]}),N?e.jsx("div",{className:"flex h-80 items-center justify-center",children:e.jsx(w,{text:"Cargando copias de seguridad, espera un momento :)"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"text-md flex items-center justify-between pt-10",children:[e.jsx(C,{Icon:K,text:`Mis respaldos (${S.length})`}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:a,onChange:n=>s(n.target.value),className:"w-full rounded-md border p-1.5 pl-8 text-sm focus:outline-none focus:ring-1 focus:ring-neutral-400 dark:border-neutral-700 dark:bg-neutral-800 dark:focus:ring-neutral-600",placeholder:"Buscar respaldo..."}),e.jsx(X,{className:"pointer-events-none absolute left-2 top-2 text-neutral-400"})]})]}),e.jsx("div",{className:"mt-4 space-y-4",children:S.length===0?e.jsx("div",{className:"flex h-80 items-center justify-center",children:e.jsx(Y,{title:"Sin resplados :(",description:"Lo sentimos, no se encontraron respaldos, por favor vuelve más tarde."})}):e.jsx("div",{className:"max-h-32 overflow-y-auto pt-4 md:max-h-64 lg:max-h-96 xl:max-h-full",children:S.map(n=>e.jsxs("div",{className:"mb-4 rounded-lg bg-neutral-100 p-4 transition-all duration-300 dark:bg-neutral-800/30",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"text-neutral-500"}),e.jsx("span",{className:"text-xs text-neutral-400",children:new Date(n.date_backup).toLocaleString()})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-2 rounded-lg bg-green-200 px-2 py-1 text-xs font-medium text-green-500 dark:bg-green-900/30",children:[e.jsx(ae,{}),e.jsx("p",{children:ie(n.size)})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("h3",{className:"font-bold text-neutral-600/80 dark:text-neutral-200",children:n.backup_name}),e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsxs(b,{variant:"outline",onClick:()=>I(n),size:"sm",children:[e.jsx(se,{className:"mr-1",size:14})," Restaurar"]}),e.jsxs(b,{variant:"danger",onClick:()=>q(n),size:"sm",children:[e.jsx(te,{className:"mr-1",size:14})," Eliminar"]})]})]})]},n.backup_number))})})]})]}),t&&e.jsx(fe,{text:"Creando respaldo. Por favor, espera un momento."}),o&&e.jsx(he,{backup:m,onClose:M,onDelete:R}),g&&e.jsx(be,{backup:m,onClose:B,onRestore:D})]})};function Ce(){return e.jsx(je,{})}export{Ce as default};
