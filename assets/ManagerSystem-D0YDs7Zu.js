import{j as e,c as j,f as U,aY as O,u as R,r as a,aN as D,E as _,aZ as $,m as z,a_ as B,a$ as F,b0 as J}from"./index-D8Kk0eQ9.js";import{S as q}from"./spinner-BF1S1dKj.js";import{d as H}from"./date.util-DC23xNcO.js";const G=({user:l,onClose:n})=>l?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-50/50 backdrop-blur-sm",children:e.jsxs("div",{className:"w-full max-w-lg rounded-lg border bg-white p-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between pb-4",children:[e.jsx("div",{className:"flex flex-row items-center gap-2 text-lg font-semibold text-slate-500",children:e.jsx("span",{children:"Detalles del usuario"})}),e.jsx("div",{onClick:n,className:"cursor-pointer rounded-md p-1.5 text-lg text-slate-400 transition-colors duration-150 hover:bg-slate-100 hover:text-slate-500",children:e.jsx(j,{})})]}),e.jsx("div",{className:"pt-4 text-slate-500",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(U,{size:80,value:l.username}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"pt-4 text-xl font-semibold text-slate-600",children:l.username}),e.jsxs("p",{className:"mb-2 text-sm text-slate-600",children:[l.email," ",e.jsx("span",{className:"ml-4 rounded-full bg-slate-500 px-4 py-0.5 text-slate-50",children:l.role.type_rol})]})]})]})})]})}):null,X=async(l=1,n=10)=>{try{return(await O.get("/",{params:{page:l,limit:n}})).data}catch(i){throw new Error(`${i.response.data.message}`)}},V=()=>{const{logout:l}=R(),[n,i]=a.useState([]),[b,p]=a.useState(!1),[v,y]=a.useState(null),[r,N]=a.useState("logs"),[w,h]=a.useState(!0),[o,c]=a.useState(1),[x,L]=a.useState(9),[d,S]=a.useState(1),[Y,C]=a.useState(0),[m,g]=a.useState(""),[u,E]=a.useState(""),k=[{label:"Logs",value:"logs"},{label:"Usuarios",value:"users"}];a.useEffect(()=>{r==="logs"&&(async()=>{try{h(!0);const t=await X(o,x);i(t.data),C(t.totalItems),S(Math.ceil(t.totalItems/x))}catch(t){console.error("Error fetching logs:",t)}finally{h(!1)}})()},[r,o,x]);const A=async s=>{try{const t=await $(s);y(t),p(!0)}catch(t){console.error("Error fetching user details:",t)}},T=s=>({error:"bg-red-100 text-red-600",success:"bg-green-100 text-green-600",warn:"bg-yellow-100 text-yellow-600",info:"bg-blue-100 text-blue-600",debug:"bg-gray-100 text-gray-600"})[s.toLowerCase()]||"bg-gray-50 text-gray-600",M=s=>({GET:"bg-green-50 text-green-600",POST:"bg-blue-50 text-blue-600",PUT:"bg-yellow-50 text-yellow-600",DELETE:"bg-red-50 text-red-600",PATCH:"bg-purple-50 text-purple-600"})[s]||"bg-gray-50 text-gray-600",P=()=>e.jsxs("nav",{className:"fixed bottom-6 left-1/2 z-10 flex -translate-x-1/2 transform items-center rounded-full border bg-slate-100 px-2 text-sm font-semibold text-slate-600 shadow-xl",children:[e.jsx("div",{className:"flex space-x-3",children:k.map(s=>e.jsx(z.button,{onClick:()=>N(s.value),initial:!1,animate:{backgroundColor:r===s.value?"#cbd5e1":"transparent",color:r===s.value?"#334155":"#6b7280"},whileHover:{scale:1},transition:{duration:.3,type:"tween"},"aria-label":s.label,className:`rounded-full px-4 py-2 text-xs font-medium transition duration-200 ${r===s.value?"bg-slate-300 text-slate-800":"hover:bg-slate-200 hover:text-slate-700"}`,children:s.label},s.value))}),e.jsxs("button",{onClick:l,"aria-label":"Logout",className:"m-2 flex cursor-pointer items-center gap-2 rounded-full px-2 py-2 text-xs text-red-600 transition-colors duration-200 hover:bg-red-100",children:[e.jsx(B,{size:20}),e.jsx("span",{className:"font-medium",children:"Cerrar sesi칩n"})]})]});function I(){return e.jsxs("div",{className:"mt-6 flex items-center justify-between space-x-4 text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsx("label",{htmlFor:"",children:"Mostar:"}),e.jsxs("select",{className:"rounded-md border bg-slate-50 px-4 py-2 text-sm",value:x,onChange:s=>{L(Number(s.target.value)),c(1)},children:[e.jsx("option",{value:9,children:"9"}),e.jsx("option",{value:18,children:"18"}),e.jsx("option",{value:27,children:"27"}),e.jsx("option",{value:36,children:"36"})]})]}),e.jsxs("div",{className:"flex gap-4 text-slate-500",children:[e.jsx("button",{className:"cursor-pointer rounded-lg bg-gray-100 px-3 transition-colors duration-200 hover:bg-slate-200",onClick:()=>c(s=>Math.max(s-1,1)),disabled:o===1,children:e.jsx(F,{})}),e.jsxs("span",{className:"p-2 text-sm",children:["P치gina ",o," de ",d]}),e.jsx("button",{className:"cursor-pointer rounded-lg bg-gray-100 px-3 transition-colors duration-200 hover:bg-slate-200",onClick:()=>c(s=>Math.min(s+1,d)),disabled:o===d,children:e.jsx(J,{})})]})]})}const f=n.filter(s=>{const t=new RegExp(m,"i");return(t.test(s.level)||t.test(s.user_fk)||t.test(s.ipAddress)||t.test(s.endpoint)||t.test(s.message)||t.test(s.createdAt))&&(u===""||s.level.toLowerCase()===u.toLowerCase())});return e.jsxs("div",{children:[e.jsx(P,{}),e.jsx("div",{className:"container mx-auto px-0 pt-10 text-slate-600",children:r==="logs"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex justify-between gap-4",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:r==="logs"?"Logs del sistema":"Usuarios del sistema"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative w-full max-w-xs",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 transform text-slate-400"}),e.jsx("input",{type:"text",placeholder:"Buscar en logs...",className:"w-full rounded-md border px-10 py-2 text-sm text-slate-600",value:m,onChange:s=>g(s.target.value)}),m&&e.jsx(j,{className:"absolute right-3 top-1/2 -translate-y-1/2 transform cursor-pointer text-slate-400",onClick:()=>g("")})]}),e.jsxs("select",{className:"rounded-md border bg-slate-50 px-4 py-2 text-sm text-slate-600",value:u,onChange:s=>{E(s.target.value),c(1)},children:[e.jsx("option",{value:"",children:"Todos "}),e.jsx("option",{value:"error",children:"Error"}),e.jsx("option",{value:"warn",children:"Advertencia"}),e.jsx("option",{value:"info",children:"Informaci칩n"}),e.jsx("option",{value:"debug",children:"Depuraci칩n"})]})]})]}),w?e.jsx(q,{}):f.length===0?e.jsx("div",{className:"m-6 pt-32",children:e.jsx(_,{title:"Sin coincidencias :(",description:"Lo sentimos, no se encontraron resultados. Por favor, busca otra cosa."})}):e.jsxs("div",{children:[e.jsx("div",{className:"max-h-[62vh] overflow-y-auto",children:e.jsx("div",{className:"w-full overflow-x-auto",children:e.jsxs("table",{className:"w-max min-w-full border-collapse bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-50 text-left",children:[e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-slate-500",children:"Nivel"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-slate-500",children:"ID usuario"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-slate-500",children:"Endpoint"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-slate-500",children:"IP"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-slate-500",children:"Mensaje"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-slate-500",children:"Meta"}),e.jsx("th",{className:"px-3 py-2 text-xs font-semibold text-slate-500",children:"Fecha"})]})}),e.jsx("tbody",{children:f.map(s=>e.jsxs("tr",{className:"text-xs",children:[e.jsx("td",{className:"px-3 py-2",children:e.jsx("span",{className:`inline-flex rounded-lg px-3 py-1 text-xs font-medium ${T(s.level)}`,children:s.level})}),e.jsx("td",{className:"w-auto cursor-pointer px-3 py-4",onClick:()=>A(s.user_fk),children:s.user_fk}),e.jsxs("td",{className:"w-auto px-3 py-2 text-xs",children:[e.jsx("span",{className:`mr-2 inline-flex items-center rounded-lg px-2 py-1 ${M(s.httpMethod)}`,children:s.httpMethod}),s.endpoint]}),e.jsx("td",{className:"px-3 py-2 text-xs",children:s.ipAddress}),e.jsx("td",{className:"w-auto px-3 py-2 text-xs",children:s.message}),e.jsx("td",{className:"w-auto px-2 py-4 text-xs",children:typeof s.meta=="string"?JSON.stringify(JSON.parse(s.meta),null,2):JSON.stringify(s.meta,null,2)}),e.jsx("td",{className:"px-3 py-2 text-xs",children:H(s.createdAt)})]},s.id))})]})})}),e.jsx(I,{})]}),e.jsx(G,{open:b,user:v,onClose:()=>p(!1)})]})})]})};export{V as default};
